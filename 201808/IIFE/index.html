<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> IIFE · Niro | 逆。</title><meta name="description" content="IIFE - NiroDu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://nirodu.com/atom.xml" title="Niro | 逆。"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="//nirodu.com/n-book" target="_self" class="nav-list-link">N-BOOK</a></li><li class="nav-list-item"><a href="https://github.com/nirodu" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container animated fadeInDown"><div class="post"><article class="post-block"><h1 class="post-title">IIFE</h1><div class="post-info">2018年8月26日</div><div class="post-content"><p>在这里简单的说一说 IIFE (Immediately Invoked Function Expressions)，立即调用函数表达式。<br>立即调用函数表达式，也称自执行函数。<br><a id="more"></a></p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><blockquote>
<p>An IIFE (Immediately Invoked Function Expression) is a JavaScript function that runs as soon as it is defined.</p>
</blockquote>
<blockquote>
<p>It is a design pattern which is also known as a Self-Executing Anonymous Function and contains two major parts. The first is the anonymous function with lexical scope enclosed within the Grouping Operator (). This prevents accessing variables within the IIFE idiom as well as polluting the global scope.<br>The second part creates the immediately executing function expression () through which the JavaScript engine will directly interpret the function.</p>
</blockquote>
<h2 id="IIFE-参数问题"><a href="#IIFE-参数问题" class="headerlink" title="IIFE 参数问题"></a>IIFE 参数问题</h2><p>先看下面一个例子：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jQuery <span class="keyword">from</span> <span class="string">'jquery'</span>;</span><br><span class="line">(<span class="function">(<span class="params">global, $</span>) =&gt;</span> &#123;</span><br><span class="line">    $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)(<span class="built_in">window</span>, jQuery);</span><br></pre></td></tr></table></figure></p>
<p>这个例子引发了我的一点疑问：1、为什么要把<code>window</code>和<code>jQuery</code>分别作为对象<code>global</code>和<code>$</code>传入到自执行函数里呢，作用是什么？</p>
<p>查了查资料，解了疑惑。<br>把<code>window</code>作为对象<code>global</code>传入的目的是将本是全局对象的<code>window</code>，注入IIFE中，便成了IIFE的局部变量<code>global</code>。<br>在有需要调用<code>window</code>对象的属性时，直接从局部变量<code>global</code>调用，不需要沿着scope chain（作用域链）一级级返回到顶层作用域<code>window</code>去，这样可以更快的访问<code>window</code>。<br>而将<code>jQuery</code>作为对象<code>$</code>传入，则是可以保证在这个IIFE内<code>$</code>就是<code>jquery</code>而不是其他类似使用<code>$</code>符号的库，避免冲突。</p>
<h2 id="正确的IIFE写法"><a href="#正确的IIFE写法" class="headerlink" title="正确的IIFE写法"></a>正确的IIFE写法</h2><p>再看一个例子：<br>请解释下面代码为什么不能用作 IIFE：<code>function foo(){ }();</code> ，需要作出哪些修改才能使其成为 IIFE？</p>
<p>JavaScript 解析器将 <code>function foo(){ }();</code> 解析成 <code>function foo(){ }</code> 和 <code>();</code> 。<br>其中，前者是函数声明；后者（一对括号）是试图调用一个函数，却没有指定名称，因此它会抛出 Uncaught SyntaxError: Unexpected token ) 的错误。<br>应做如下修改：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改1：</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123; &#125;)();</span><br><span class="line"><span class="comment">// 修改2：</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123; &#125;());</span><br><span class="line"><span class="comment">// 修改3 ES6：</span></span><br><span class="line">(foo() =&gt; &#123; &#125;)(); <span class="comment">// With ES6 arrow functions (though parentheses only allowed on outside)</span></span><br></pre></td></tr></table></figure></p>
<h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><p><a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE" target="_blank" rel="noopener">IIFE - MDN Web Docs Glossary: Definitions of Web-related terms | MDN</a><br><a href="http://lucybain.com/blog/2014/immediately-invoked-function-expression/" target="_blank" rel="noopener">Lucy | JS Immediately Invoked Function Expressions</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/201805/年会项目小记/" class="next">NEXT</a></div><div class="copyright"><p>© 2016 - 2018 <a href="https://nirodu.com">NiroDu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>